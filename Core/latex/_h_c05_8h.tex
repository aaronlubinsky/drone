\doxysection{Inc/\+HC05.h File Reference}
\hypertarget{_h_c05_8h}{}\label{_h_c05_8h}\index{Inc/HC05.h@{Inc/HC05.h}}


Bluetooth HC-\/05 module interface for receiving control input.  


{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{_h_c05_8h_a83f5acf008b13325bde24f48268f13b9}{process\+Input}} (char \texorpdfstring{$\ast$}{*}char\+Buf, int32\+\_\+t \texorpdfstring{$\ast$}{*}roll, int32\+\_\+t \texorpdfstring{$\ast$}{*}pitch, int32\+\_\+t \texorpdfstring{$\ast$}{*}yaw, int32\+\_\+t \texorpdfstring{$\ast$}{*}effort, int \texorpdfstring{$\ast$}{*}dump\+Flag)
\begin{DoxyCompactList}\small\item\em Parses input from the HC-\/05 Bluetooth module. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_h_c05_8h_a649f4d21cf63078c636631ef6269a882}{dump\+Blackbox}} (void)
\begin{DoxyCompactList}\small\item\em Outputs the blackbox flight data via UART. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Bluetooth HC-\/05 module interface for receiving control input. 

This file contains functions to process incoming UART data and handle blackbox data dumping for debugging purposes.

\begin{DoxyAuthor}{Author}
Aaron 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
May 14, 2025 
\end{DoxyDate}


\label{doc-func-members}
\Hypertarget{_h_c05_8h_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{_h_c05_8h_a649f4d21cf63078c636631ef6269a882}\index{HC05.h@{HC05.h}!dumpBlackbox@{dumpBlackbox}}
\index{dumpBlackbox@{dumpBlackbox}!HC05.h@{HC05.h}}
\doxysubsubsection{\texorpdfstring{dumpBlackbox()}{dumpBlackbox()}}
{\footnotesize\ttfamily \label{_h_c05_8h_a649f4d21cf63078c636631ef6269a882} 
void dump\+Blackbox (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Outputs the blackbox flight data via UART. 

This function is used for offline analysis or debugging.

Outputs the blackbox flight data via UART.

Sends all recorded flight data from the blackbox buffer via UART to the connected Bluetooth device. Data is transmitted in CSV format with one sample per line containing pitch, pitch setpoint, roll, and roll setpoint values.

Output format per line\+: "{}pitch,pitch\+Set,roll,roll\+Set\textbackslash{}r\textbackslash{}n"{} All values are in millidegrees.

\begin{DoxyNote}{Note}
Function transmits all samples up to current sample\+\_\+index 

200ms delay added to allow receiver to process data 

Data transmission is blocking (waits for completion) 

Currently only transmits pitch and roll data (yaw commented out)
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
Large blackbox buffers may take significant time to transmit 

Ensure receiver can handle the data rate 

Function blocks until all data is transmitted
\end{DoxyWarning}
\begin{DoxySeeAlso}{See also}
\doxylink{_h_c05_8h_a83f5acf008b13325bde24f48268f13b9}{process\+Input()} 

Initialize\+BT() 
\end{DoxySeeAlso}
\texorpdfstring{$<$}{<} Message buffer for each data line\Hypertarget{_h_c05_8h_a83f5acf008b13325bde24f48268f13b9}\index{HC05.h@{HC05.h}!processInput@{processInput}}
\index{processInput@{processInput}!HC05.h@{HC05.h}}
\doxysubsubsection{\texorpdfstring{processInput()}{processInput()}}
{\footnotesize\ttfamily \label{_h_c05_8h_a83f5acf008b13325bde24f48268f13b9} 
void process\+Input (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{char\+Buf}{, }\item[{int32\+\_\+t \texorpdfstring{$\ast$}{*}}]{roll}{, }\item[{int32\+\_\+t \texorpdfstring{$\ast$}{*}}]{pitch}{, }\item[{int32\+\_\+t \texorpdfstring{$\ast$}{*}}]{yaw}{, }\item[{int32\+\_\+t \texorpdfstring{$\ast$}{*}}]{effort}{, }\item[{int \texorpdfstring{$\ast$}{*}}]{dump\+Flag}{}\end{DoxyParamCaption})}



Parses input from the HC-\/05 Bluetooth module. 

\texorpdfstring{$<$}{<} Standard integer types For printf() debugging 


\begin{DoxyParams}{Parameters}
{\em char\+Buf} & Pointer to the received character buffer. \\
\hline
{\em roll} & Pointer to variable storing parsed roll value. \\
\hline
{\em pitch} & Pointer to variable storing parsed pitch value. \\
\hline
{\em yaw} & Pointer to variable storing parsed yaw value. \\
\hline
{\em effort} & Pointer to variable storing parsed throttle/effort value. \\
\hline
{\em dump\+Flag} & Pointer to a flag indicating whether to dump blackbox data.\\
\hline
\end{DoxyParams}
Parses input from the HC-\/05 Bluetooth module.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em char\+Buf} & Input string buffer containing control data \\
\hline
\mbox{\texttt{out}}  & {\em roll} & Pointer to store calculated roll setpoint (millidegrees) \\
\hline
\mbox{\texttt{out}}  & {\em pitch} & Pointer to store calculated pitch setpoint (millidegrees) \\
\hline
\mbox{\texttt{out}}  & {\em yaw} & Pointer to store calculated yaw setpoint (millidegrees) \\
\hline
\mbox{\texttt{out}}  & {\em effort} & Pointer to store/update throttle effort value \\
\hline
\mbox{\texttt{out}}  & {\em dump\+Flag} & Pointer to store blackbox dump request flag\\
\hline
\end{DoxyParams}
Parses comma-\/separated joystick and button data from the control device. Expected input format\+: "{}\#\+Ljoy\+X,\+Ljoy\+Y,\+Rjoy\+X,\+LT,\+RT,\+ENTER"{}

Control mapping\+:
\begin{DoxyItemize}
\item Left joystick X/Y → Roll/\+Pitch commands (±20° range)
\item Right joystick X → Yaw rate command (relative to current heading)
\item Left/\+Right triggers → Throttle increase/decrease
\item Enter button → Trigger blackbox data dump
\end{DoxyItemize}

\begin{DoxyNote}{Note}
Input must start with \textquotesingle{}\#\textquotesingle{} character for validation 

Roll/\+Pitch scaled from joystick ±1000 range to ±20° (±20000 millidegrees) 

Yaw command is relative to current heading with wraparound 

Effort is constrained between 0 and 1000, 0 is transformed to large negative number, ensuring no spin due to PID loop 

Invalid inputs increment bad\+BTcount and are rejected
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
Pointers must be valid and point to allocated memory 

Function modifies input buffer (uses strtok)
\end{DoxyWarning}
\begin{DoxySeeAlso}{See also}
Initialize\+BT() 

\doxylink{_h_c05_8h_a649f4d21cf63078c636631ef6269a882}{dump\+Blackbox()} 
\end{DoxySeeAlso}
\texorpdfstring{$<$}{<} Parsed joystick and button values